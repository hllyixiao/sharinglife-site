<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="cn.com.sharinglife.mapper.LikesMapper">

    <insert id="addLikeArticle">
        insert into likes_article(articleid,userid,deleted)
        values(#{articleId},#{userId},0)
        on duplicate key update deleted = 0
    </insert>

    <insert id="addLikePicture">
        insert into likes_picture(pictureid,userid,deleted)
        values(#{pictureId},#{userId},0)
        on duplicate key update deleted = 0
    </insert>

    <insert id="addLikeVideo">
        insert into likes_video(videoid,userid,deleted)
        values(#{videoId},#{userId},deleted)
        on duplicate key update deleted = 0
    </insert>

    <update id="deleteLikeArticle">
        update likes_article set deleted = 1
        where articleid = #{articleId} and userid = #{userId}
    </update>

    <update id="deleteLikePicture">
        update likes_picture set deleted = 1
        where pictureid = #{pictureId} and userid = #{userId}
    </update>

    <update id="deleteLikeVideo">
        update likes_video set deleted = 1
        where videoid = #{videoId} and userid = #{userId}
    </update>

    <select id="isLikeArticleByUserId" resultType="boolean">
        SELECT EXISTS (
        SELECT *
        FROM likes_article
        WHERE articleid = #{articleId}
        and userid = #{userId}
        and deleted = 0
        )
    </select>

    <select id="isLikePictureByUserId" resultType="boolean">
        SELECT EXISTS (
        SELECT *
        FROM likes_picture
        WHERE articleid = #{articleId}
        and userid = #{userid}
        and deleted = 0
        )
    </select>

    <select id="isLikeVideoByUserId" resultType="boolean">
        SELECT EXISTS (
        SELECT *
        FROM likes_video
        WHERE articleid = #{articleId}
        and userid = #{userid}
        and deleted = 0
        )
    </select>
</mapper>